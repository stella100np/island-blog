---
// Component Imports
import BlogHeader from '../components/BlogHeader.astro';
import BaseHead from "../components/BaseHead.astro";
import BlogPostPreview from '../components/BlogPostPreview.astro';
import siteMetadata from "../data/siteMetadata";
// import { Sandpack } from '@codesandbox/sandpack-react'
import BodyLayout from '../layouts/BodyLayout.astro';
import { Icon } from "astro-icon";


const MAX_DISPLAY = 5

// Data Fetching: List all Markdown posts in the repo.

let allPosts = await Astro.glob('./posts/*.mdx');
allPosts = allPosts.sort((a, b) => new Date(b.frontmatter.publishDate).valueOf() - new Date(a.frontmatter.publishDate).valueOf());

// Full Astro Component Syntax:
// https://docs.astro.build/core-concepts/astro-components/
---

<html lang="en">
<BaseHead title={siteMetadata.title} description={siteMetadata.description}></BaseHead>
<BodyLayout>
	<BlogHeader />
	<main class="max-w-[52rem] mx-auto px-4 pb-28 sm:px-6 md:px-8 xl:px-12 lg:max-w-6xl">
		<section class="space-y-2 pt-6 pb-8 md:space-y-5">
			<h2
				class="text-3xl font-extrabold leading-9 tracking-tight text-gray-900 dark:text-gray-100 sm:text-4xl sm:leading-10 md:text-6xl md:leading-14">
				Latest
			</h2>
			<p class="text-lg leading-7 text-gray-500 dark:text-gray-400">
				{siteMetadata.description}
			</p>
		</section>
		<section
			class="relative sm:pb-12 sm:ml-[calc(2rem+1px)] md:ml-[calc(3.5rem+1px)] lg:ml-[max(calc(14.5rem+1px),calc(100%-48rem))]">
			<div
				class="hidden absolute top-3 bottom-0 right-full mr-7 md:mr-[3.25rem] w-px bg-slate-200 dark:bg-slate-800 sm:block">
			</div>
			<div class="space-y-16">
				{!allPosts.length && 'No posts found.'}
				{allPosts.slice(0,MAX_DISPLAY).map((item) =>
				<BlogPostPreview post={item} /> )}
				{
				allPosts.length > MAX_DISPLAY && (
				<div class="flex justify-end text-base font-medium leading-6">
					<a href="/blog" class=" inline-flex items-center text-sky-500 hover:text-sky-600 dark:hover:text-sky-400"
						aria-label="all posts">
						All posts
						<Icon name="heroicons-outline:arrow-narrow-right" class='h-5' />
					</a>
				</div>
				)
				}
			</div>
		</section>
	</main>
</BodyLayout>

</html>