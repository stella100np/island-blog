---
title: "FLIP ç³»ç»Ÿä»‹ç»ï¼šä»€ä¹ˆæ˜¯ FLIP"
publishDate: '2022-08-08'
tags: ['FLIP', 'animation', 'flutter', 'vue', 'react']
draft: false
name: Nate Moore
description: FLIP æ˜¯ First, Last, Invert, Play å››ä¸ªå•è¯çš„é¦–å­—æ¯ç¼©å†™
layout: '../../layouts/BlogPost.astro'
---

æˆ–è®¸ä½ å·²ç»è§åˆ°è¿‡ `FLIP` è¿™ç§æŠ€æœ¯åˆ¶ä½œçš„åŠ¨ç”»äº†ã€‚åœ¨ flutter æˆ–è€… material design ä¸­ï¼Œ`FLIP` åŠ¨ç”»è¢«ç§°"hero animation"ã€‚[ä¸€ä¸ªå…¸å‹çš„ä¾‹å­](https://codepen.io/davidkpiano/pen/JKEraQ/305a618d4dd75cbe8423183c70d6a43e?editors=1111)ï¼šåœ¨å›¾ç‰‡ç€‘å¸ƒæµä¸­ï¼Œç‚¹å‡»æŸä¸ªå›¾ç‰‡ï¼Œé¡µé¢å‘ç”Ÿè·³è½¬ï¼Œå›¾ç‰‡ä¸æ»‘åœ°æ”¾å¤§å¹¶ä¸”å‡ºç°åœ¨äº†å¦ä¸€ä¸ªé¡µé¢ä¸Šã€‚

## ä»€ä¹ˆæ˜¯ FLIP

- First æŒ‡åŠ¨ç”»å…ƒç´ çš„åˆå§‹çŠ¶æ€
- Last æŒ‡åŠ¨ç”»å…ƒç´ çš„æœ€ç»ˆçŠ¶æ€
- Invert æŒ‡å…ˆè®¡ç®—æœ€ç»ˆçŠ¶æ€åˆ°æœ€åˆçŠ¶æ€çš„å·®å€¼ï¼Œç„¶åå‘åŠ¨ç”»å…ƒç´ æ–½åŠ è´Ÿçš„å·®å€¼ï¼Œç›®çš„æ˜¯å°†åŠ¨ç”»å…ƒç´ å˜æ¢å›å…¶åˆå§‹çŠ¶æ€
- Play æŒ‡ç§»é™¤ Invert ä¸­è¿›è¡Œçš„å˜æ¢æ“ä½œã€å¹¶åˆ©ç”¨ [requestAnimationFrame](https://developer.mozilla.org/zh-CN/docs/Web/API/Window/requestAnimationFrame)ã€[Web Animations API](https://developer.mozilla.org/zh-CN/docs/Web/API/Web_Animations_API) å®ŒæˆåŠ¨ç”»ã€‚

è¿™æ ·åœ°è§£é‡Šæ˜¾å¾—æŠ½è±¡ä¸”æ¯ç‡¥ï¼Œä¸‹é¢å°†é€æ­¥ä»‹ç»å…¶ä¸­æŠ€æœ¯ç»†èŠ‚ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ FLIP æŠ€æœ¯

åŠ¨ç”»å¾€å¾€ç»™äºˆç”¨æˆ·æœ‰è¶£è€Œæ·±åˆ»åœ°ä½“éªŒï¼Œä»è€Œä½¿ä½ çš„ç½‘é¡µè„±é¢–è€Œå‡ºã€‚CSS åŠ¨ç”»è™½ç„¶èƒ½å¤Ÿæ»¡è¶³å¤§å¤šæ•°æƒ…å†µä¸‹çš„éœ€æ±‚ï¼Œä½†æ˜¯åœ¨åŠ¨ç”»å½¢å¼ä¸äº¤äº’ä½“éªŒä»ç„¶æœ‰è¯¸å¤šé™åˆ¶ï¼Œè€Œ `FLIP` è¿™ä¸€åŠ¨ç”»å½¢å¼æˆ–å¯å¼¥è¡¥ CSS åŠ¨ç”»çš„éƒ¨åˆ†ç¼ºé™·ã€‚`FLIP` æŠ€æœ¯å¤§é‡ä½¿ç”¨äº† JavaScript æ¥æ“ä½œ html ä¸­çš„åŠ¨ç”»å…ƒç´ ï¼Œè¿™æ ·æ›´åŠ çµæ´»ï¼Œå¹¶ä¸”åˆç†çš„æŠ€æœ¯åº”ç”¨ä¾ç„¶èƒ½å®ç° 60FPS é«˜æµç•…åŠ¨ç”»ã€‚

### FLIP ä»£ç ä¾‹å­

```js 
// è·å–å…ƒç´ çš„å¼€å§‹çš„ä½ç½® -- First
let first = el.getBoundingClientRect()

// ğŸ”§ åšä¸€äº›æ“ä½œï¼Œè®©å…ƒç´ ç§»åŠ¨ä½ç½®æˆ–è€…æ”¹å˜é€æ˜åº¦
el.classList.add('totes-at-the-end')

// âŒ› è·å–å…ƒç´ çš„ç»“æŸä½ç½® -- Last
let last = el.getBoundingClientRect()

//  è®¡ç®—æœ€ç»ˆçŠ¶æ€åˆ°æœ€åˆçŠ¶æ€çš„å·®å€¼ -- Invert
const invert = first.top - last.top

//  å€ŸåŠ© Web Animations API ç§»é™¤ Invert ä¸­è¿›è¡Œçš„å˜æ¢æ“ä½œ -- Play
const player = el.animate(
  [{ transform: `translateY(${invert}px)` }, { transform: 'translateY(0)' }],
  {
    duration: 300,
    easing: 'cubic-bezier(0,0,0.32,1)',
  }
)

// å¯é€‰ï¼ŒåŠ¨ç”»ç»“æŸåšä¸€äº›æ•´ç†
player.addEventListener('finish', tidyUpAnimations)
```

çœ‹èµ·æ¥ååˆ†åœ°ç®€å•ï¼Œä½†æ˜¯è¿™é‡Œæœ‰ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆåœ¨è¿›è¡Œä¸€äº› js æ“ä½œä¹‹åï¼Œç«‹å³è¿›è¡Œå…ƒç´ ä½ç½®çš„è·å–ï¼Œå°±ä¼šå¾—åˆ°æ–°çš„ä½ç½®ï¼Œè€Œä¸æ˜¯æ—§çš„ä½ç½®ï¼Ÿ

### FLIP æ·±å±‚åŸç†

å½“æˆ‘ä»¬æ‰§è¡Œäº† `el.classList.add('totes-at-the-end')` ä»£ç ä¹‹åï¼Œæµè§ˆå™¨å°±ä¼šç«‹å³è¿›è¡Œå¸ƒå±€ï¼ˆLayoutï¼‰æ¥é‡æ–°è®¡ç®—å…ƒç´ çš„ä½ç½®ã€‚ä¸€æ–¹é¢ï¼Œåœ¨æ‰§è¡Œ `let last = el.getBoundingClientRect()` æ—¶ï¼Œå¸ƒå±€ï¼ˆLayoutï¼‰å·²ç»å®Œæˆäº†ï¼Œè‡ªç„¶ä¼šå¾—åˆ°å…ƒç´ æ–°çš„ä½ç½®ï¼Œå¦ä¸€æ–¹é¢ï¼Œè¿™æ˜¯æµè§ˆå™¨çš„ç»˜å›¾ï¼ˆPaintï¼‰æµç¨‹è¿˜æ²¡æœ‰å¼€å§‹ï¼Œåœ¨å±å¹•ä¸Šå…ƒç´ è¿˜åœ¨å®ƒæ—§çš„ä½ç½®ï¼Œç­‰åˆ°ä¸Šé¢çš„ js ä»£ç å…¨éƒ¨æ‰§è¡Œå®Œæˆæ‰å¼€å§‹ç»˜å›¾ï¼ˆPaintï¼‰ç­‰ä¹‹åçš„æ­¥éª¤ã€‚

æ€»çš„æ¥è¯´ï¼Œ`FLIP` æŠ€æœ¯åˆ©ç”¨æµè§ˆå™¨æ¸²æŸ“æµç¨‹ä¸­çš„å¸ƒå±€ä¸ç»˜å›¾æµç¨‹ï¼Œæ‰€ä»¥ç†è§£å…¶åŸç†éœ€è¦å¼€å‘è€…å¯¹æµè§ˆå™¨æ¸²æŸ“æœ‰ä¸€å®šçš„äº†è§£ã€‚

ä¹‹åï¼Œæˆ‘å°†ä»‹ç» `FLIP` çš„å„ç§åº”ç”¨ï¼ŒåŒ…æ‹¬åœ¨ `vue` å’Œ `react` ç­‰æ¡†æ¶ä¸­ã€‚



3. Add the following frontmatter property in `post-1.md`

    ```markdown title="src/pages/posts/post-1.md" ins={2}
    ---
    layout: ../../layouts/MarkdownPostLayout.astro
    title: 'My First Blog Post'
    pubDate: 2022-07-01
    description: 'This is the first post of my new Astro blog.'
    author: 'Astro Learner'
    image:
        url: 'https://astro.build/assets/blog/astro-1-release-update/cover.jpeg' 
        alt: 'The Astro logo with the word One.'
    tags: ["astro", "blogging", "learning in public"]
    ---
    ```